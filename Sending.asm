.MODEL SMALL
.STACK 32

.DATA
VALUE DB ?

.CODE
INITIALIZE_PORT PROC 
    MOV DX, 3FBH
    MOV AL, 10000000B
    OUT DX, AL
    MOV DX, 3F8h
    MOV AL, 0CH
    OUT DX, AL
    MOV BX, 3F9H
    MOV AL, 00H
    OUT DX, AL
    MOV DX, 3FBH
    MOV AL, 00011011B
    OUT DX, AL
    RET
INITIALIZE_PORT ENDP

SEND_VALUE PROC 
    MOV DX, 3FDH
AGAIN:
    IN AL, DX
    AND AL, 00100000B
    JZ AGAIN
    MOV DX, 3F8H
    MOV AL, VALUE
    OUT DX, AL
    RET
SEND_VALUE ENDP

MAIN PROC FAR
    MOV AX, @DATA
    MOV DS, AX
    CALL INITIALIZE_PORT

    MOV AH, 01H
    INT 21H

    MOV VALUE, AL

    CALL SEND_VALUE
    
    HLT
MAIN ENDP
END MAIN